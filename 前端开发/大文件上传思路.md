待整理

1. 实现哪些功能，解决哪些问题
2. 如何实现

# 过程

1. 前端，利用 Blob.prototype.slice 进行文件切片，固定切片大小，自己封装 XMLHttpRequest 发送请求。发送时用文件 hash（web worker 中计算）加索引作为文件名传输，还要发送文件大小。上传完成后发送请求通知后端完成上传。
2. 后端，接收切片，使用中间件 busboy 接收文件。接收到合并请求后并发合并切片，根据 createWriteStream 的第二个参数可以控制切片合并位置。
3. 进度条，监听 xhr.upload.onprogress 事件，文件上传了多少。并且需要做一个假进度条，解决暂停进度条后退的问题。
4. 断点续传：服务端保存已上传的切片 hash，前端上传前获取已上传的切片 hash。
5. 暂停上传：xhr.abort() 每当一个切片上传成功时，将对应的 xhr 从 requestList 中删除
6. 优化：
   - 利用浏览器空余时间计算 hash 值，requestIdleCallback
   - 抽样 hash，将数据切片，首尾切片数据保留，中间切片取样（前中后取两个字节），再进行计算。（布隆过滤器思想）
   - 请求并发数控制和重试
   - 慢启动策略，根据网速调整切片大小（未实现，借鉴 TCP 慢启动）

# 并发数控制

writtern-examination/请求并发数控制/请求并发数控制.html

- 加一个并发数参数配置，不要影响到其他正常的请求
